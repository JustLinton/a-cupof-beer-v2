---
title: gitè‡ªåŠ¨åŒ–åˆæ¢ğŸš€
date: 2022-04-20 07:13:07
tags: [æŠ€æœ¯]
summary: åœ¨æœåŠ¡å™¨ä¸Šåšnachosçš„æœ€ä½³é€‰æ‹©ï¼


---



### æ­å»ºgitä»“åº“

ä¸ºäº†å®‰å…¨ï¼Œæ–°å»ºgitç”¨æˆ·ï¼Œå¹¶è®¾ç½®å¯†ç 

```
useradd git
passwd git
```

å¯ä»¥åœ¨gitç”¨æˆ·çš„å®¶ä¸­å»ºç«‹ä¸€ä¸ª.gitç›®å½•ï¼Œä½œä¸ºä»“åº“æ–‡ä»¶å¤¹ï¼š

```
cd ï½
mkdir nesto.git
```

è¿›å…¥å®ƒï¼Œåˆå§‹åŒ–ä¸ºç©ºä»“åº“ï¼š

```
cd nesto.git
git init --bare .
```

å…è®¸è¢«pushï¼š

```
git config receive.denyCurrentBranch ignore
```

###### æµ‹è¯•gitä»“åº“[#](https://a.cupof.beer/posts/how-to-deploy-your-web-project-on-a-server/#æµ‹è¯•gitä»“åº“)

å…ˆæŠŠæœ¬åœ°ä»“åº“æ·»åŠ è¯¥remoteï¼š

```
git remote add dep git@111.111.111.111:/home/git/nestob.git
```

111.111.111.111æ˜¯æœåŠ¡å™¨ipã€‚

depæ˜¯è¯¥è¿œç¨‹é…ç½®çš„åç§°ï¼Œå¯ä»¥éšæ„æŒ‡å®šã€‚

è¯¥æ“ä½œçš„èŒƒå›´åªæ˜¯æ›´æ”¹æœ¬ä»“åº“ã€‚

ç„¶åå°±å¯ä»¥pushäº†ï¼š

```
git push -u dep master
```

###### åˆ©ç”¨git hookæ¥å®ç°è‡ªåŠ¨éƒ¨ç½²[#](https://a.cupof.beer/posts/how-to-deploy-your-web-project-on-a-server/#åˆ©ç”¨git-hookæ¥å®ç°è‡ªåŠ¨éƒ¨ç½²)

git hookå°±åƒreact hookä¸€æ ·ï¼Œä¼šåœ¨ç‰¹å®šçš„äº‹ä»¶å‘ç”Ÿæ—¶æ‰§è¡Œä¸€å®šçš„æ“ä½œã€‚è¿™é‡Œæ˜¯shè„šæœ¬ã€‚

è¿›å…¥hookså­˜æ”¾ç›®å½•ï¼š

```
cd /home/git/nestob.git/hooks
```

åˆ›å»ºpost-receiveé’©å­ï¼Œä½¿æ”¶åˆ°pushåå¯ä»¥è‡ªåŠ¨æ‹‰å–ä»£ç åˆ°æœåŠ¡å™¨çš„é¡¹ç›®ç›®å½•ï¼š

```
vi post-receive
```

å†™å…¥ï¼š

```
#!/bin/bash
git --work-tree=/home/admin/nachos/code/lab5_git checkout -f
```

**ç„¶åè®°å¾—æˆäºˆå¯æ‰§è¡Œæƒé™ï¼š**

```
chmod +x post-receive
```

è¿™æ ·åšçš„æ•ˆæœå°±æ˜¯ï¼Œå½“æ¥æ”¶åˆ°pushï¼Œå°±ä¼šè‡ªåŠ¨æŠŠä»£ç æ‹‰å–åˆ°/home/website/wwwrootç›®å½•ä¸‹ã€‚ç›¸å½“äºå®Œæˆäº†è‡ªåŠ¨éƒ¨ç½²ã€‚

å¯¹äºgoè¯­è¨€ä¸€ç±»çš„éœ€è¦åœ¨ç›®æ ‡æœºå™¨ä¸Šç¼–è¯‘å†è¿è¡Œçš„ï¼Œè¿˜å¯ä»¥åœ¨æ­¤è¿›è¡Œè‡ªåŠ¨ç¼–è¯‘ã€‚

**éœ€è¦æ³¨æ„ï¼Œä¸€å®šè¦ä¿è¯gitç”¨æˆ·æ‹¥æœ‰å¯¹/home/website/wwwrootçš„å†™æƒé™ï¼Œä¹Ÿå°±æ˜¯å°†æ¨¡å¼ä¿®æ”¹ä¸º777.**

å› ä¸ºä¸€èˆ¬ç›®å½•çš„æ¨¡å¼éƒ½æ˜¯`drwxrwxr-x`ï¼Œç¬¬ä¸‰åˆ—æ˜¯å¯¹æ‰€æœ‰ç”¨æˆ·çš„æƒé™ï¼Œæ‰€ä»¥æ”¹æˆ`drwxrwxrwx`ï¼Œå³777.

```
chmod 777 lab5_git
```

